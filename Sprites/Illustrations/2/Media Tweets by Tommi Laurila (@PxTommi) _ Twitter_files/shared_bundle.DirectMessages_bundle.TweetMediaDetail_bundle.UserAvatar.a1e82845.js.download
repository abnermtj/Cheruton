(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{"2doW":function(t,e,o){"use strict";o("Ysgh");var n=o("KEM+"),s=o.n(n),i=o("ERkP"),a=(o("kYxP"),o("97Jx")),r=o.n(a),l=o("LdEA"),h=o.n(l),d=o("aWzz"),c=(o("IAdD"),o("JtPf"),o("FwvS")),m=o("3XMw"),u=o.n(m),p=o("mN6z"),_=o("U+bB"),g=o("MWbm"),f=o("CHgo"),y=o("fs1G"),v=o("7nmT"),C=o.n(v),b=o("rHpw"),x=o("rOXj"),D=o("Enqy");const w=x.a.isTouchSupported(),M={zoom:1,lastX:0,lastY:0,zoomCenter:{x:0,y:0}},S={height:0,width:0,left:0,right:0,top:0,bottom:0},P=(t,e,o)=>Math.min(e,Math.max(t,o)),E=(t,e)=>Math.sqrt(Math.pow(t.clientY-e.clientY,2)+Math.pow(t.clientX-e.clientX,2));class T extends i.Component{constructor(t){super(t),s()(this,"_itemDimensions",S),s()(this,"_setTouchableNode",t=>{this._touchableNode=C.a.findDOMNode(t),this._touchableNode&&(this._removeTouchListener=Object(f.a)(this._touchableNode,this._handleTouchMove,!1))}),s()(this,"_handleTouchStart",t=>{this._zoomable instanceof Element&&(this._zoomedDimensions=this._zoomable.getBoundingClientRect()),this._moved=!1;const e=t.touches.length;2===e?(t.preventDefault(),this._handlePinchStart(t)):1===e&&this._handleTapStart(t)}),s()(this,"_handleTouchMove",t=>{const e=t.touches.length;2===e?this._handlePinchMove(t):1===e&&(this._moved=!0,this._handlePanMove(t)),t.preventDefault()}),s()(this,"_handleTouchEnd",t=>{const{maxZoom:e,minZoom:o,onTap:n}=this.props,s=P(o,e,this.state.zoom),{zoom:i}=this.state;i!==s&&1===s?this.resetZoom():this.setState({lastX:0,lastY:0,zoom:s}),0===t.touches.length?(this._lastTouchTime&&this._lastTouchTime+300>t.timeStamp?(this._clickTimer&&clearTimeout(this._clickTimer),this._handleDoubleTap(t)):i<=1&&!this._moved&&(this._clickTimer=setTimeout(n,300)),this._lastTouchTime=t.timeStamp):t.preventDefault()}),this.state=Object.assign({},M),this._ref=i.createRef()}static getDerivedStateFromProps(t,e){return w&&t.resetZoom?(t.onZoomed(!1),Object.assign({},M)):e}render(){if(!w)return this.props.children;const{zoom:t,zoomCenter:e}=this.state,o=this._moved,n={zoom:Object(D.spring)(t),zoomCenterX:Object(D.spring)(e.x),zoomCenterY:Object(D.spring)(e.y)};return i.createElement(g.a,{onTouchEnd:this._handleTouchEnd,onTouchStart:this._handleTouchStart,ref:this._setTouchableNode,style:I.fill},i.createElement(D.Motion,{style:n},({zoom:t,zoomCenterX:n,zoomCenterY:s})=>i.createElement(g.a,{ref:this._ref,style:[I.fill,{transform:[{scale:t}],transformOrigin:`${o?n:e.x}px ${o?s:e.y}px`}]},this.props.children)))}componentDidMount(){w&&(this._zoomable=C.a.findDOMNode(this._ref.current),this._updateWindowDimensions())}componentWillUnmount(){this._removeTouchListener&&this._removeTouchListener()}resetZoom(){this.props.onZoomed(!1),this.setState({zoom:M.zoom})}_handlePanMove(t){if(this.state.zoom<=1||!this._zoomedDimensions||!this._windowDimensions)return;const{clientX:e,clientY:o}=t.touches[0];if(!this.state.lastX||!this.state.lastY)return void this.setState({lastX:e,lastY:o});const{lastX:n,lastY:s,zoomCenter:{x:i,y:a}}=this.state,{height:r,width:l}=this._windowDimensions,{height:h,width:d}=this._zoomedDimensions;let c=0,m=0;d-l>0&&(c=e-n),h-r>0&&(m=o-s),this.setState({lastX:e,lastY:o,zoomCenter:{x:Math.min(Math.max(i-c,0),l),y:Math.min(Math.max(a-m,0),r)}})}_handlePinchStart(t){const{touches:e}=t;if(this._updateWindowDimensions(),this._lastDistance=E(e[0],e[1]),1===this.state.zoom){const t=(o=e[0],n=e[1],{x:(o.clientX+n.clientX)/2,y:(o.clientY+n.clientY)/2});this.setState({zoomCenter:this._getZoomCenter(t.x,t.y)}),this.props.onZoomed(!0)}var o,n}_handlePinchMove(t){const{zoom:e,zoomCenter:o}=this.state,{maxZoom:n,maxZoomBounce:s,minZoom:i,minZoomBounce:a}=this.props;if(0===o.x&&0===o.y)return void(2===t.touches.length&&this._handlePinchStart(t));const r=E(t.touches[0],t.touches[1]),l=this._lastDistance?r/this._lastDistance:1,h=P(i-a,n+s,e*l);this._lastDistance=r,this.setState({zoom:h})}_handleTapStart(t){const{touches:e}=t;this._tapCenter=this._getZoomCenter(e[0].clientX,e[0].clientY)}_handleDoubleTap(t){const{maxZoom:e,onZoomed:o}=this.props;1!==this.state.zoom?this.resetZoom():(this._updateWindowDimensions(),this.setState({zoom:e,zoomCenter:this._tapCenter||M.zoomCenter}),o(!0))}_getZoomCenter(t,e){this._zoomable instanceof Element&&(this._itemDimensions=this._zoomable.getBoundingClientRect());const{left:o,top:n}=this._itemDimensions;return{x:t-o,y:e-n}}_updateWindowDimensions(){this._windowDimensions={height:window.innerHeight,width:window.innerWidth}}}s()(T,"defaultProps",{maxZoom:2.5,maxZoomBounce:.15,minZoom:1,minZoomBounce:.15,onTap:y.a,onZoomed:y.a,resetZoom:!1});const I=b.a.create(t=>({fill:{flex:1}}));var z=T,Z=o("r1lV"),L=o("JYMr");const O=u.a.b327c129,k=u.a.gff1f69e;class R extends i.PureComponent{constructor(...t){super(...t),s()(this,"state",{loadingVariant:null,imageLoading:!1}),s()(this,"_handleLoadStart",()=>this.setState({imageLoading:!0})),s()(this,"_handleLoadEnd",()=>this.setState({imageLoading:!1}))}componentDidMount(){this._mountPromiseForTesting=R._selectCachedVariant(this.props.photo).then(t=>this.setState({loadingVariant:t}))}componentDidUpdate(t,e){Object(p.a)(t.photo,this.props.photo)||(this.setState({loadingVariant:null}),R._selectCachedVariant(this.props.photo).then(t=>this.setState({loadingVariant:t})))}render(){const{dataSaver:t,onContextMenu:e,onError:o,onLoad:n,onTap:s,onZoomed:a,photo:r,resetZoom:l,zoomable:h,style:d,imageStyle:c}=this.props,{loadingVariant:m}=this.state,u=(t&&m&&Math.max(m.width,m.height)>=680?m.uri:null)||R._selectSource(r);if(!u||null===m)return null;const p=i.createElement(_.a,{accessibilityLabel:r.ext_alt_text?r.ext_alt_text:O,defaultSource:m&&m.uri,draggable:!0,onContextMenu:e,onError:m?void 0:o,onLoad:n,onLoadEnd:this._handleLoadEnd,onLoadStart:this._handleLoadStart,resizeMode:"contain",source:u,style:[B.img,c]});return i.createElement(g.a,{style:d},this.state.imageLoading?Y:null,h?i.createElement(z,{onTap:s,onZoomed:a,resetZoom:l},p):p)}static _selectCachedVariant(t){const e=c.c(t);return e?Z.a.selectLargestCachedVariant(e):Promise.resolve()}static _selectSource(t){const e=c.c(t);return e&&Z.a.selectLargestUrl(e)}}s()(R,"defaultProps",{zoomable:!1});const B=b.a.create(t=>({img:Object.assign({},b.a.absoluteFillObject,{height:"auto",margin:"auto",maxHeight:"100%",maxWidth:"100%",width:"auto"}),progressBar:{position:"absolute",top:0,zIndex:1}})),Y=i.createElement(L.a,{ariaValueText:k,indeterminate:!0,style:B.progressBar});var j=R,W=o("RCZO"),X=o("KdqI"),U=o("TrHT"),V=o("Modb");class A extends i.PureComponent{constructor(...t){super(...t),s()(this,"_handlePlaybackStarted",()=>{this._player&&!this.props.isCurrentlyDisplayed&&this._player.pause()}),s()(this,"_setPlayer",t=>{this._player=t,this._player&&this.props.isCurrentlyDisplayed&&this._player.play()})}render(){const{style:t}=this.props;return i.createElement(g.a,{style:t},i.createElement(g.a,{style:N.root},this._renderVideo()))}componentDidUpdate(t){const{isCurrentlyDisplayed:e}=this.props;this._player&&e!==t.isCurrentlyDisplayed&&(e?this._player.play():this._player.pause())}_renderVideo(){const{promotedContent:t,video:e,videoId:o}=this.props;return i.createElement(V.a,r()({},Object(U.a)(o,e),{onPlaybackStarted:this._handlePlaybackStarted,playbackCoordination:null,promotedContent:t,setPlayer:this._setPlayer,withPostPlayback:!0}))}}const N=b.a.create({root:{flexBasis:0,flexGrow:1,flexShrink:1,justifyContent:"center"}});var H=A;const J={startX:0,startY:0};class F extends i.Component{constructor(...t){super(...t),s()(this,"_pullDistanceY",0),s()(this,"_pullInfo",Object.assign({},J)),s()(this,"_handleTouchStart",t=>{this._pullInfo.startX=t.touches[0].clientX,this._pullInfo.startY=t.touches[0].clientY}),s()(this,"_handleTouchMove",t=>{if("number"!=typeof this._pullInfo.startX||"number"!=typeof this._pullInfo.startY)return;const e=t.touches[0],o=e.clientX-this._pullInfo.startX,n=e.clientY-this._pullInfo.startY;Math.abs(o)>10||(t.preventDefault(),this._updatePullPosition(n))}),s()(this,"_handleTouchEnd",t=>{Math.abs(this._pullDistanceY)>50?this._handleDismiss():this._resetPullInfo()}),s()(this,"_updatePullPosition",t=>{this._pullDistanceY=t}),s()(this,"_handleDismiss",()=>{const{onDismiss:t}=this.props;t&&t(),this._resetPullInfo()}),s()(this,"_resetPullInfo",()=>{this._updatePullPosition(0),this._pullInfo=Object.assign({},J)})}render(){const{children:t,onDismiss:e,onLayout:o,style:n}=this.props,s=!!e;return i.createElement(g.a,{onLayout:o,onTouchEnd:s?this._handleTouchEnd:void 0,onTouchMove:s?this._handleTouchMove:void 0,onTouchStart:s?this._handleTouchStart:void 0,style:n},t)}}var q=F,G=o("q9Zt"),K=o("mjJ+"),$=o("JsJV");const Q=u.a.ac85c6b1,tt=u.a.f46c1d5e;class et extends i.Component{constructor(...t){super(...t),s()(this,"state",{error:null,contextMenuPoint:{top:0,left:0},showContextMenu:!1,containerDimensions:{width:0,height:0}}),s()(this,"_handleError",t=>{this.setState({error:t.nativeEvent.error})}),s()(this,"_handleLoad",()=>{this.setState({error:null})}),s()(this,"_handleMediaPress",t=>{t.stopPropagation()}),s()(this,"_handleRetry",()=>{this.setState({error:null})}),s()(this,"_handleContextMenu",t=>{Object(X.e)()&&(t.preventDefault(),t.stopPropagation(),this.setState({contextMenuPoint:{left:t.clientX,top:t.clientY}}),this.setState({showContextMenu:!0}))}),s()(this,"_handleContextCancel",()=>this.setState({showContextMenu:!1})),s()(this,"_handleOpenImageURI",()=>{$.a.openURL(this.props.mediaDetail.media_url_https),this._handleContextCancel()}),s()(this,"_getContextMenuItems",()=>[{text:tt,onClick:this._handleOpenImageURI}]),s()(this,"_handleLayout",t=>{const{nativeEvent:{layout:{height:e,width:o}}}=t;this.setState({containerDimensions:{width:o,height:e}})})}shouldComponentUpdate(t,e){return!Object(p.a)(t,this.props)||!Object(p.a)(e,this.state)}UNSAFE_componentWillReceiveProps(t){this.setState({error:null,showContextMenu:!1})}render(){let t;const e=this.props,{isCurrentlyDisplayed:o,mediaDetail:n,onDismiss:s,onTap:a,promotedContent:l,videoId:d,isAvatar:c}=e,m=h()(e,["isCurrentlyDisplayed","mediaDetail","onDismiss","onTap","promotedContent","videoId","isAvatar"]),{width:u,height:p}=n.original_info||{},{error:_,showContextMenu:f,containerDimensions:{width:y,height:v}}=this.state,{isModal:C}=this.context,b=C||c?Object(W.e)({mediaWidth:u,mediaHeight:p,containerWidth:y,containerHeight:v},c):ot.mediaItem;return n&&(t=["animated_gif","video","vine"].indexOf(n.type)>-1),i.createElement(q,{onDismiss:s,onLayout:C||c?this._handleLayout:void 0,style:ot.root},_?i.createElement(G.a,{onRetry:this._handleRetry,style:ot.errorDetail,title:Q,withLightOnDarkColorScheme:!0}):null,f?i.createElement(K.a,{items:this._getContextMenuItems(),onCloseRequested:this._handleContextCancel,position:this.state.contextMenuPoint}):null,_?null:i.createElement(g.a,{onClick:this._handleMediaPress,style:b},"photo"===n.type?i.createElement(j,r()({},m,{imageStyle:c&&ot.avatarImage,onContextMenu:this._handleContextMenu,onError:this._handleError,onLoad:this._handleLoad,onTap:a,photo:n,style:ot.container,zoomable:!0})):null,t&&d?i.createElement(H,{isCurrentlyDisplayed:o,promotedContent:l,style:ot.container,video:n,videoId:d}):null))}}s()(et,"contextTypes",{isModal:d.bool});const ot=b.a.create(t=>({root:{flexGrow:1,justifyContent:"center",alignItems:"center",flexShrink:1},mediaItem:{flexGrow:1,width:"100%",height:"100%"},container:{height:"100%",position:"absolute",width:"100%"},errorDetail:{alignItems:"center",alignSelf:"center",justifyContent:"center",position:"absolute",height:"100%",maxWidth:400},avatarImage:{borderRadius:t.borderRadii.infinite,margin:t.spaces.small}}));var nt=et,st=o("lklz"),it=o("cHvH"),at=o("uavX");class rt extends i.Component{constructor(t,e){super(t,e),s()(this,"_getWithReducedNavButtonClickArea",(t,e)=>t<b.a.theme.breakpoints.large||this._isItemVideo(e)),s()(this,"_isItemVideo",t=>["video","animated_gif","vine"].includes(t.type)),s()(this,"_getItemVideoId",t=>{const{videoId:e}=this.props;return e||(t=>st.b.forTweet(t.expanded_url.split("/")[3]))(t)}),s()(this,"_handleMediaDetailZoomed",t=>{const{onMediaDetailZoomed:e}=this.props;this.state.isZoomed!==t&&this.setState({isZoomed:t}),e&&e(t)}),this.state={isZoomed:!1}}shouldComponentUpdate(t,e){return!Object(p.a)(t,this.props)||!Object(p.a)(e,this.state)}render(){const{dataSaver:t,dominantColor:e,mediaIndex:o,mediaItems:n,onDismiss:s,onMediaItemChanged:a,onTap:r,promotedContent:l}=this.props,{isZoomed:h}=this.state,d=n.map((e,a)=>{const d=this._isItemVideo(e),c=this._getItemVideoId(e),m=o===a;return d&&c||!d?i.createElement(nt,{dataSaver:t,isAvatar:this.props.isAvatar,isCurrentlyDisplayed:m,key:a,mediaDetail:n[a],onDismiss:h?void 0:s,onTap:r,onZoomed:m?this._handleMediaDetailZoomed:void 0,promotedContent:l,resetZoom:o!==a,videoId:c}):null});return i.createElement(it.a,null,({windowWidth:t})=>i.createElement(g.a,{style:lt.root},n.length>1?i.createElement(at.a,{currentSlide:o,dominantColor:e,locked:h||1===n.length,onChange:a,shouldAlwaysEnableKeyboardNavigation:!0,withReducedNavButtonClickArea:this._getWithReducedNavButtonClickArea(t,n[o])},d):d))}}s()(rt,"defaultProps",{mediaIndex:0,onMediaDetailZoomed:y.a,onMediaItemChanged:y.a});const lt=b.a.create(t=>({root:{flex:1,zIndex:1}}));e.a=rt},JsJV:function(t,e,o){"use strict";var n=o("6/RC"),s=o("tI3i"),i=o.n(s),a=n.canUseDOM?window.location.href:"",r={addEventListener:function(){},removeEventListener:function(){},canOpenURL:function(){return Promise.resolve(!0)},getInitialURL:function(){return Promise.resolve(a)},openURL:function(t){try{return l(t),Promise.resolve()}catch(t){return Promise.reject(t)}},_validateURL:function(t){i()("string"==typeof t,"Invalid URL: should be a string. Was: "+t),i()(t,"Invalid URL: cannot be empty")}},l=function(t){n.canUseDOM&&(window.location=new URL(t,window.location).toString())};e.a=r},UPvq:function(t,e,o){"use strict";o.d(e,"a",(function(){return f}));o("IAdD"),o("kYxP");var n=o("KEM+"),s=o.n(n),i=o("ERkP"),a=o("RCZO"),r=o("aWzz"),l=o("3XMw"),h=o.n(l),d=o("hOZg"),c=o("MWbm"),m=o("mw9i"),u=o("cm6r"),p=o("/yvb"),_=o("rHpw");const g=h.a.ia5e7487;class f extends i.Component{constructor(...t){super(...t),s()(this,"_handleCloseButtonPress",t=>{t.stopPropagation();const{onCloseButtonPress:e}=this.props;e()}),s()(this,"_handleBackgroundPress",()=>{const{onCloseButtonPress:t}=this.props,{isModal:e}=this.context;e&&t()})}render(){const{children:t,backgroundColor:e,mediaItem:o,mediaUrl:n,hideButtons:s,topRightButton:r,footerButtons:l,overlayFooter:h}=this.props,{isModal:_}=this.context,f=Object.assign({backgroundColor:e.rgba},a.a),v=Object.assign({backgroundColor:e.rgb},a.a),C=[y.root,_?f:v,{position:_?"relative":"fixed"}];return i.createElement(i.Fragment,null,i.createElement(c.a,{onClick:this._handleBackgroundPress,style:C},t,l?i.createElement(c.a,{pointerEvents:s?"none":void 0,style:[y.footerButtons,h&&f,h&&y.footerButtonsAbsolute,s&&y.fadeOut]},i.createElement(m.a,{withGutter:!0},l)):null),i.createElement(u.a,{accessibilityRole:"none",interactiveStyles:null,onClick:this._handleCloseButtonPress,pointerEvents:s?"none":void 0,style:[y.buttonWrapper,y.buttonWrapperLeft,a.a,s&&y.fadeOut]},t=>i.createElement(p.a,{accessibilityLabel:g,dominantColor:e.rgb,icon:i.createElement(d.a,null),interactivityState:t,onClick:this._handleCloseButtonPress,type:o||n?"onMedia":"invertedPrimary"})),r?i.createElement(c.a,{pointerEvents:s?"none":void 0,style:[y.buttonWrapper,y.buttonWrapperRight,a.a,s&&y.fadeOut]},r):null)}}s()(f,"contextTypes",{isModal:r.bool}),s()(f,"defaultProps",{hideButtons:!1});const y=_.a.create(t=>({root:{overflowX:"hidden",overflowY:"hidden",height:"100%",width:"100%"},buttonWrapper:{position:"absolute",top:0,padding:t.spaces.xSmall,alignItems:"center",justifyContent:"center",cursor:"pointer"},buttonWrapperLeft:{left:0},buttonWrapperRight:{right:0},fadeOut:{opacity:0},footerButtons:{width:"100%",alignSelf:"center"},footerButtonsAbsolute:{position:"absolute",bottom:0,paddingBottom:_.a.iPhoneOffsetBottom,zIndex:1}}))}}]);
//# sourceMappingURL=https://ton.twitter.com/responsive-web-internal/sourcemaps/client-web/shared~bundle.DirectMessages~bundle.TweetMediaDetail~bundle.UserAvatar.a1e82845.js.map